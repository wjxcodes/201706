
jQuery.thisCommon={uiResizable:function(){$('.ui-resizable-e').mousedown(function(e){var x=e.pageX;var z=$('#leftdiv').width();$(document).bind('mousemove',function(e){var c=parseInt(z)+(e.pageX-x);if(c<200)c=200;if(c>400)c=400;$('#leftdiv').css('width',c+"px");$('#rightdiv').css('left',c+"px");$("#rightdiv").width($(window).width()-$("#leftdiv").outerWidth());});$(document).mouseup(function(a){$(document).unbind('mousemove');});});}}
jQuery.knowledgeTest={init:function(){this.loadClassList();this.loadTestEvent();this.initDivBoxHeight();this.knowledgeTreeClick();this.loadPageEvent();$.thisCommon.uiResizable();$(window).bind("resize",function(){$.knowledgeTest.initDivBoxHeight();});},loadPageEvent:function(){this.jumpToPage();this.goPrevPage();this.goNextPage();this.quickToPage();},loadTestEvent:function(){this.getTest();this.showTestByOrder();this.showTestByDiff();this.showTestByKnowledge();this.showTestBySource();this.knowledgeAllTest();this.showTestByTypes();this.showTestByDocTypes();},loadClassList:function(){var subjectName=$.myCommon.getSubjectNameFromParent();$('#loca_text').html(subjectName);$.post(U('Manual/Index/getZsdInit'),{'id':subjectID,'m':Math.random()},function(data){if($.myCommon.backLogin(data)==false){lock='';return false;}
$('#categorytop').append('('+subjectName+')');var str='<div class="filterbox_li"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="45">题型</td><td><span id="questypeselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][1]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][1][i]['TypesID']+'">'+data['data'][1][i]['TypesName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div><div class="filterbox_li"><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="65">难度系数</td><td><span id="quesdiffselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][2]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][2][i]['DiffID']+'" title="'+data['data'][2][i]['DiffArea']+'">'+data['data'][2][i]['DiffName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div><div class="filterbox_li" ><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="65">文档类型</td><td><span id="quesdoctypeselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][4]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][4][i]['TypeID']+'" title="'+data['data'][4][i]['TypeName']+'">'+data['data'][4][i]['TypeName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div><div class="filterbox_li" style="background:none"><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="65">文档来源</td><td><span id="quesdocSourceselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][5]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][5][i]['SourceID']+'" title="'+data['data'][5][i]['SourceName']+'">'+data['data'][5][i]['SourceName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div>';$('#filterbox').html(str);str='';for(var i=0;i<data['data'][3].length;i++){str+='<li><span></span><a href="#" class="zsd" qyid="'+data['data'][3][i]['KlID']+'" title="'+data['data'][3][i]['KlName']+'">'+$.myCommon.cutString(data['data'][3][i]['KlName'],26,'...')+'</a>';if(data['data'][3][i]['sub']){str+='<ul>';for(var j=0;j<data['data'][3][i]['sub'].length;j++){str+='<li><span></span><a href="#" class="zsd" qyid="'+data['data'][3][i]['sub'][j]['KlID']+'" title="'+data['data'][3][i]['sub'][j]['KlName']+'">'+$.myCommon.cutString(data['data'][3][i]['sub'][j]['KlName'],24,'...')+'</a>';if(data['data'][3][i]['sub'][j]['sub']){str+='<ul>';for(var k=0;k<data['data'][3][i]['sub'][j]['sub'].length;k++){str+='<li><span></span><a href="#" class="zsd" qyid="'+data['data'][3][i]['sub'][j]['sub'][k]['KlID']+'" title="'+data['data'][3][i]['sub'][j]['sub'][k]['KlName']+'">'+$.myCommon.cutString(data['data'][3][i]['sub'][j]['sub'][k]['KlName'],22,'...')+'</a></li>';}
str+='</ul>';}
str+='</li>';}
str+='</ul>';}
str+='</li>';}
$('#treecon').html(str);$('#treecon').tree({expanded:'li:first'});});},gotoPage:function(num){$("#rightdiv").scrollTop(0);if(num<1&&page==1){return false;}
page=num;$.knowledgeTest.getTest();},goPrevPage:function(){$('.prev_page').live('click',function(){if($.myPage.goPrevPage()==false)return false;$.knowledgeTest.gotoPage(page);});},goNextPage:function(){$('.next_page').live('click',function(){if($.myPage.goNextPage()==false)return false;$.knowledgeTest.gotoPage(page);});},jumpToPage:function(){$('.pagebox a').live('click',function(){$.knowledgeTest.gotoPage(parseInt($(this).attr('page')));});},quickToPage:function(){$('#quicktopage a').live('click',function(){$.myPage.quickToPage($(this));$.knowledgeTest.gotoPage(page);});},showTestByKnowledge:function(){$('.zsd').live('click',function(){$('.zsd').css('background-color','#3366ff');$('.zsd').attr('jl','');$(this).css('background-color','#3399ff');$(this).attr('jl','down');page=1;$.knowledgeTest.getTest();});},knowledgeTreeClick:function(){$('.tree span').live('click',function(){$('.zsd').css('background-color','#3399ff');$('.zsd').attr('jl','');$(this).next().css('background-color','#3399ff');$(this).next().attr('jl','down');});},knowledgeAllTest:function(){$('#categorytop').css('cursor','pointer').live('click',function(){page=1;$('.zsd').css({'background-color':'#3333ff','border-color':'#3E5061','font-weight':'normal'});$('.zsd').attr('jl','');$.knowledgeTest.getTest();});},showTestByTypes:function(){$('#questypeselect a').live('click',function(){$(this).setButtonBackground();$.knowledgeTest.getTest();});},showTestByDocTypes:function(){$('#quesdoctypeselect a').live('click',function(){$(this).setButtonBackground();$.knowledgeTest.getTest();});},showTestByDiff:function(){$('#quesdiffselect a').live('click',function(){$(this).setButtonBackground();$.knowledgeTest.getTest();});},showTestBySource:function(){$('#quesdocSourceselect a').live('click',function(){$(this).setButtonBackground();$.knowledgeTest.getTest();});},showTestByOrder:function(){$('#list_px a.button').live('click',function(){page=1;$(this).aOrderColor();$.knowledgeTest.getTest();});},getDiff:function(){return $('#quesdiffselect').getButtonSelected('qdid');},getDocType:function(){return $('#quesdoctypeselect').getButtonSelected('qdid');},getOrder:function(){return $('#list_px').getButtonSelected('type');},getSource:function(){return $('#quesdocSourceselect').getButtonSelected('qdid');},getKnowledge:function(){var output=0;$('.zsd').each(function(){if($(this).attr('jl')=='down'){output=$(this).attr('qyid');return true;}});return output;},getTypes:function(){return $('#questypeselect').getButtonSelected('qdid');},getTest:function(){var kid=this.getKnowledge();var tid=this.getTypes();var dtid=this.getDocType();var dif=this.getDiff();var order=this.getOrder();var sourceID=this.getSource();$("#queslistbox").html('<p class="list_ts"><span class="ico_dd">试题加载中请稍候...</span></p>');lock='test';$.post(U('Home/Index/getTestList'),{'sid':subjectID,'kid':kid,'tid':tid,'dtid':dtid,'dif':dif,'o':order,'page':page,'sourceid':sourceID,'rand':Math.random()},function(data){if($.myCommon.backLogin(data)==false){$("#queslistbox").html('<p class="list_ts">抱歉！暂时没有符合条件的试题，请尝试更换查询条件。</p>');$.myPage.showPage(0,1,page,1);lock='';return false;};if(data['data'][1]!=0)$("#queslistbox").html($.myTest.showTest(data['data'][0]));else $("#queslistbox").html('<p class="list_ts">抱歉！暂时没有符合条件的试题，请尝试更换查询条件。</p>');$.myPage.showPage(data['data'][1],data['data'][2],page,1);lock='';});},initDivBoxHeight:function(){var a=$(window).width();var b=$(window).height();var c=0;$(".mleft,.mright").height(b-c-2);$("#rightdiv").width(a-$("#leftdiv").outerWidth());$("#leftdiv").height(b-c-2);$("#rightdiv").height(b-c-2);$("#categorytreebox").height(b-c-$('#categorytop').outerHeight());}}
jQuery.chapterTest={subjectName:'',init:function(){this.loadClassList();this.loadTestEvent();this.initDivBoxHeight();this.loadPageEvent();$.thisCommon.uiResizable();$(window).bind("resize",function(){$.chapterTest.initDivBoxHeight();});},loadPageEvent:function(){this.jumpToPage();this.goPrevPage();this.goNextPage();this.quickToPage();},loadTestEvent:function(){this.showChapterBBEvent();this.showChapterBB();this.treeSpanClick();this.treeCategoryClick();this.showTestByOrder();this.showTestByDiff();this.showTestByChapter();this.showTestByTypes();this.showTestByDocType();this.showTestByAbility();this.showTestBySource();},loadClassList:function(){$.chapterTest.subjectName=$.myCommon.getSubjectNameFromParent();$.post(U('Home/Index/getTypes'),{'id':subjectID,'style':1,'m':Math.random()},function(data){if($.myCommon.backLogin(data)==false){return false;};var str='';str='<div class="filterbox_li"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="45">题型</td><td><span id="questypeselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][1]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][1][i]['TypesID']+'">'+data['data'][1][i]['TypesName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div><div class="filterbox_li"><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="65">难度系数</td><td><span id="quesdiffselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][2]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][2][i]['DiffID']+'" title="'+data['data'][2][i]['DiffArea']+'">'+data['data'][2][i]['DiffName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div><div class="filterbox_li" ><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="65">文档类型</td><td><span id="quesdoctypeselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][4]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][4][i]['TypeID']+'" title="'+data['data'][4][i]['TypeName']+'">'+data['data'][4][i]['TypeName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div><div class="filterbox_li" style="background:none"><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="65">文档来源</td><td><span id="quessourceselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][6]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][6][i]['SourceID']+'" title="'+data['data'][6][i]['SourceName']+'">'+data['data'][6][i]['SourceName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div>';$('#filterbox').html(str);str='';str+='<div class="filterbox_li" style="background:none;display:none;"><table  border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>“<span class="nowchapter"></span>”课后推荐习题　</td><td><span id="quesabilityselect"><a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][5]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][5][i]['AbID']+'" title="'+data['data'][5][i]['AbilitName']+'">'+data['data'][5][i]['AbilitName']+'</a>';}
str+='</span></td><td> </td></tr></tbody></table></div>';$('#ability').hide();$('#ability').html(str);});},gotoPage:function(num){$("#rightdiv").scrollTop(0);if(num<1&&page==1){return false;}
page=num;$.chapterTest.getTest();},goPrevPage:function(){$('.prev_page').live('click',function(){if($.myPage.goPrevPage()==false)return false;$.chapterTest.gotoPage(page);});},goNextPage:function(){$('.next_page').live('click',function(){if($.myPage.goNextPage()==false)return false;$.chapterTest.gotoPage(page);});},jumpToPage:function(){$('.pagebox a').live('click',function(){$.chapterTest.gotoPage(parseInt($(this).attr('page')));});},quickToPage:function(){$('#quicktopage a').live('click',function(){$.myPage.quickToPage($(this));$.chapterTest.gotoPage(page);});},showChapterBBEvent:function(){$('#curcategory').live('mouseenter',function(){$('#othercategories').css({'display':'block'});});$('#curcategory').live('mouseleave',function(){$('#othercategories').css({'display':'none'});});$('#othercategories a').live('click',function(){var tmp_cid=$('#curcategoryname').attr('categoryid');var tmp_cname=$('#curcategoryname').html();$('#curcategoryname').attr('categoryid',$(this).attr('cid'));$('#curcategoryname').html($(this).attr('title'));$(this).parent().remove();$('#othercategories').css({'display':'none'});$('#othercategories').append('<div><a class="banben" title="'+tmp_cname+'" cid="'+tmp_cid+'">〓'+tmp_cname+'</a></div>');$('#loca_text').html($.chapterTest.subjectName+$(this).attr('title'));$.chapterTest.initSelect();$.chapterTest.getChapterList($('#curcategoryname').attr('categoryid'));$.chapterTest.getTest();});},showChapterBB:function(){$.post(U('Home/Index/getData'),{'style':'chapter','subjectID':subjectID,'times':Math.random()},function(data){if($.myCommon.backLogin(data)==false){return false;};var str='<span id="curcategory" style="position:relative;">';str+='<span id="curcategoryname" categoryid="'+data['data'][0]['ChapterID']+'" title="'+$.chapterTest.subjectName+data['data'][0]['ChapterName']+'">'+data['data'][0]['ChapterName']+'</span><a id="categorymore"></a>';if(data['data'].length>1){str+='<div id="othercategories" style="top:32px;_top:16px;z-index:100;display:none;">';for(var i=1;i<data['data'].length;i++){str+='<div>'+'<a class="banben" title="'+data['data'][i]['ChapterName']+'" cid="'+data['data'][i]['ChapterID']+'">〓'+data['data'][i]['ChapterName']+'</a>'+'</div>';}
str+='</div>';}
str+='</span>';$('#loca_text').html($.chapterTest.subjectName+data['data'][0]['ChapterName']);$('#categorytop .tit:eq(0)').append(str);$.chapterTest.getChapterList(data['data'][0]['ChapterID']);$.chapterTest.getTest();});},getChapterSub:function(thisData,layer){if(typeof(layer)=='undefined'||layer=='')layer=1;var this_str='';for(var i=0;i<thisData.length;i++){this_str+='<li><span></span><a href="#" class="cp" qyid="'+thisData[i]['ChapterID']+'" title="'+thisData[i]['ChapterName']+'">'+$.myCommon.cutString(thisData[i]['ChapterName'],(28-layer*2),'...')+'</a>';if(thisData[i]['sub']){this_str+='<ul>'+$.chapterTest.getChapterSub(thisData[i]['sub'],layer+1)+'</ul>';}
this_str+='</li>';}
return this_str;},getChapterList:function(id){$('#treecon').html('<p class="list_ts" style="color:#fff">数据加载中请稍候...</p>');$.post(U('Home/Index/getData'),{'style':'chapter','pID':id,'haveLayer':3,'times':Math.random()},function(data){if($.myCommon.backLogin(data)==false){return false;};if(data['data']){$('#treecon').html($.chapterTest.getChapterSub(data['data']));$('#treecon').tree({expanded:'li:first'});}});},initSelect:function(){if($('#questypeselect a:eq(0)').attr('class').indexOf('button_current')==-1){$('#questypeselect a:eq(0)').setButtonBackground();}
if($('#quesdiffselect a:eq(0)').attr('class').indexOf('button_current')==-1){$('#quesdiffselect a:eq(0)').setButtonBackground();}
if($('#quesdoctypeselect a:eq(0)').attr('class').indexOf('button_current')==-1){$('#quesdoctypeselect a:eq(0)').setButtonBackground();}
if($('#list_px a:eq(0)').attr('class').indexOf('button_current')==-1){$('#list_px a:eq(0)').setButtonBackground();}},initAbilitySelect:function(){$('#quesabilityselect a:eq(0)').setButtonBackground();},showTestByChapter:function(){$('.cp').live('click',function(){$('#quesabilityselect a').addClass('button').removeClass('button_current');$('#quesabilityselect a').first().addClass('button_current').removeClass('button');$('.cp').css('background-color','#3399ff');$('.cp').attr('jl','');$(this).css('background-color','#3333ff');$(this).attr('jl','down');if(typeof($(this).prev().attr('class'))=='undefined'){$('#ability').show();$('.filterbox_li').last().show();$('.filterbox_li').eq(2).attr('style','');$('.nowchapter').html($(this).text());}else{$('#ability').hide();$('.filterbox_li').last().hide();$('.filterbox_li').eq(2).attr('style','background: none');$('#quesabilityselect a').addClass('button').removeClass('button_current');$('#quesabilityselect a').first().addClass('button_current').removeClass('button');}
$('#loca_text').html($.chapterTest.subjectName+$('#curcategoryname').html()+' > '+$.chapterTest.getPathForChapter($(this)));page=1;$.chapterTest.getTest();});},getPathForChapter:function(obj){var tmpStr='';tmpStr=obj.html()+' > '+tmpStr;if(obj.parent().parent().attr('id')!='treecon'){tmpStr=$.chapterTest.getPathForChapter(obj.parent().parent().prev())+tmpStr;}
return tmpStr;},treeSpanClick:function(){$('.tree span').live('click',function(){$('.cp').css('background-color','#3399ff');$('.cp').attr('jl','');$(this).next().css('background-color','#3333ff');$(this).next().attr('jl','down');});},treeCategoryClick:function(){$('#categorytop').css('cursor','pointer').live('click',function(){$.chapterTest.initSelect();page=1;$('.cp').css({'background-color':'#3399ff','border-color':'#3E5061','font-weight':'normal'});$('.cp').attr('jl','');$('#loca_text').html($.chapterTest.subjectName+$('#curcategoryname').html());$.chapterTest.getTest();});},showTestByTypes:function(){$('#questypeselect a').live('click',function(){$.chapterTest.initAbilitySelect();$(this).setButtonBackground();$.chapterTest.getTest();});},showTestByDiff:function(){$('#quesdiffselect a').live('click',function(){$.chapterTest.initAbilitySelect();$(this).setButtonBackground();$.chapterTest.getTest();});},showTestByDocType:function(){$('#quesdoctypeselect a').live('click',function(){$.chapterTest.initAbilitySelect();$(this).setButtonBackground();$.chapterTest.getTest();});},showTestByAbility:function(){$('#quesabilityselect a').live('click',function(){$.chapterTest.initSelect();$(this).setButtonBackground();$.chapterTest.getTest();});},showTestBySource:function(){$('#quessourceselect a').live('click',function(){$.chapterTest.initAbilitySelect();$(this).setButtonBackground();$.chapterTest.getTest();});},showTestByOrder:function(){$('#list_px a.button').live('click',function(){page=1;$(this).aOrderColor();$.chapterTest.getTest();});},getDiff:function(){return $('#quesdiffselect').getButtonSelected('qdid');},getOrder:function(){return $('#list_px').getButtonSelected('type');},getAbility:function(){return $('#quesabilityselect').getButtonSelected('qdid');},getTypes:function(){return $('#questypeselect').getButtonSelected('qdid');},getDocType:function(){return $('#quesdoctypeselect').getButtonSelected('qdid');},getChapter:function(){var output=0;$('.cp').each(function(){if($(this).attr('jl')=='down'){output=$(this).attr('qyid');return true;}});if(output==0)output=$('#curcategoryname').attr('categoryid');return output;},getSource:function(){return $('#quessourceselect').getButtonSelected('qdid');},getTest:function(){var cid=this.getChapter();var tid=this.getTypes();var dif=this.getDiff();var dtid=this.getDocType();var order=this.getOrder();var abi=this.getAbility();var sourceID=this.getSource();$("#queslistbox").html('<p class="list_ts"><span class="ico_dd">试题加载中请稍候...</span></p>');lock='test';$.post(U('Home/Index/getTestList'),{'randoms':1,'sid':subjectID,'sourceid':sourceID,'abi':abi,'cid':cid,'tid':tid,'dtid':dtid,'dif':dif,'o':order,'page':page,'rand':Math.random()},function(data){if($.myCommon.backLogin(data)==false){lock='';$.myPage.showPage(0,1,page,1);$("#queslistbox").html('<p class="list_ts">抱歉！暂时没有符合条件的试题，请尝试更换查询条件。</p>');return false;};if(data['data'][1]!=0)$("#queslistbox").html($.myTest.showTest(data['data'][0]));else $("#queslistbox").html('<p class="list_ts">抱歉！暂时没有符合条件的试题，请尝试更换查询条件。</p>');$.myPage.showPage(data['data'][1],data['data'][2],page,1);lock='';});},initDivBoxHeight:function(){var a=$(window).width();var b=$(window).height();var c=0;$(".mleft,.mright").height(b-c-2);$("#rightdiv").width(a-$("#leftdiv").outerWidth());$("#leftdiv").height(b-c-2);$("#rightdiv").height(b-c-2);$("#categorytreebox").height(b-c-$('#categorytop').outerHeight());}}
jQuery.docTest={init:function(){this.initDivBoxHeight();if($('#showDocID').val()!=''){this.openTestDoc($('#showDocID').val(),$('#showSubjectID').val());}
this.loadClassList();this.loadDocEvent();this.loadPageEvent();$(window).bind("resize",function(){$.docTest.initDivBoxHeight();});},loadPageEvent:function(){this.jumpToPage();this.goPrevPage();this.goNextPage();this.quickToPage();},loadDocEvent:function(){this.barClick();this.paperView();this.addTestAll();this.paperClose();this.getKeyword();this.getDoc();this.showDocByOrder();this.showDocByGrade();this.showDocByArea();this.showDocByDocType();},loadClassList:function(){$('#loca_text').html($.myCommon.getSubjectNameFromParent());$.get(U('Manual/Index/getDocInit?id='+subjectID+'&times='+Math.random()),function(data){if($.myCommon.backLogin(data)==false){return false;}
var str='';str='<a href="javascript:void(0);" class="button_current" thisid="0" qdid="0">全部</a>';for(var i in data['data'][1]){str+='<a href="javascript:void(0);" class="button" thisid="'+data['data'][1][i]['GradeList']+'" qdid="'+data['data'][1][i]['TypeID']+'">'+data['data'][1][i]['TypeName']+'</a>';}
$('#questypeselect').html(str);str='';str='<a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][2]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][2][i]['AreaID']+'">'+data['data'][2][i]['AreaName']+'</a>';}
$('#quesareaselect').html(str);str='';str='<a href="javascript:void(0);" class="button_current" qdid="0">全部</a>';for(var i in data['data'][3]){str+='<a href="javascript:void(0);" class="button" qdid="'+data['data'][3][i]['GradeID']+'">'+data['data'][3][i]['GradeName']+'</a>';}
$('#questypegrade').html(str);});},gotoPage:function(num){$("#switchbox").scrollTop(0);if(num<1&&page==1){return false;}
page=num;$.docTest.getDoc();},goPrevPage:function(){$('.prev_page').live('click',function(){if($.myPage.goPrevPage()==false)return false;$.docTest.gotoPage(page);});},goNextPage:function(){$('.next_page').live('click',function(){if($.myPage.goNextPage()==false)return false;$.docTest.gotoPage(page);});},jumpToPage:function(){$('.pagebox a').live('click',function(){$.docTest.gotoPage(parseInt($(this).attr('page')));});},quickToPage:function(){$('#quicktopage a').live('click',function(){$.myPage.quickToPage($(this));$.docTest.gotoPage(page);});},clickNums:function(ID,className){var clicknum=$('#'+ID+' a').length;var canclick=$('#'+ID+' .'+className).length;var click=clicknum-canclick;var allClick='';if($('#'+ID+' a').eq(0).attr('class').indexOf('noclick')!=-1){$('#'+ID+' a').eq(0).addClass('button');$('#'+ID+' a').eq(0).removeClass('noclick');}
if(parseInt(click)<=1){$('#'+ID+' a').removeClass('noclick');$('#'+ID+' a').addClass('button');$('#'+ID+' a').each(function(){if($(this).attr('class').indexOf('button_current')!=-1){allClick='false';}});if(allClick==''){$('#'+ID+' a').removeClass('button_current');$('#'+ID+' a').eq(0).addClass('button_current');}}},showDocByGrade:function(){$('#questypegrade a').live('click',function(){if($(this).attr('class')=='noclick')return false;$(this).setButtonBackground();var gradeID=$(this).attr('qdid');var gradeList='';$("#questypeselect a").each(function(){gradeList=$(this).attr('thisid');if(gradeID==0){if($(this).attr('class')=='noclick'){$(this).addClass('button');$(this).removeClass('noclick');}}else{if((','+gradeList+',').indexOf(','+gradeID+',')==-1){if($(this).attr('qdid')!='0'){$(this).removeClass('button');$(this).addClass('noclick');}}else{$(this).addClass('button');$(this).removeClass('noclick');}}});$.docTest.clickNums('questypeselect','button');$.docTest.getDoc();});},showDocByDocType:function(){$('#questypeselect a').live('click',function(){if($(this).attr('class')=='noclick')return false;$(this).setButtonBackground();var gradeID=$(this).attr('thisid');var gradeList='';var button='';$("#questypegrade a").each(function(){gradeList=$(this).attr('qdid');if(gradeID==0){if($(this).attr('class')=='noclick'){$(this).addClass('button');$(this).removeClass('noclick');}}else{if((','+gradeID+',').indexOf(','+gradeList+',')==-1){$(this).addClass('noclick');$(this).removeClass('button');}else{$(this).addClass('button');$(this).removeClass('noclick');}}});$.docTest.clickNums('questypegrade','button');$.docTest.getDoc();});},showDocByArea:function(){$('#quesareaselect a').live('click',function(){$(this).setButtonBackground();$.docTest.getDoc();});},showDocByOrder:function(){$('#doc_px a').live('click',function(){page=1;$(this).aOrderColor();$.docTest.getDoc();});},barClick:function(){$('#bartitle .nav').live('click',function(event){event.stopPropagation();var _this=$(this);$('#bartitle .nav_current').addClass('nav').removeClass('nav_current');_this.addClass('nav_current').removeClass('nav');var id=_this.attr('id');if(id=='paperlisthandler'){$('#paperlistbox').css({'display':'block'});$('#paperviewbox').css({'display':'none'});$('#switchbox').scrollTop(0);}else{$('#paperlistbox').css({'display':'none'});$('#paperviewbox').css({'display':'block'});$('.papercontent').css({'display':'none'});$('#papercontent'+id.replace('papernav','')).css({'display':'block'});$('#switchbox').scrollTop(0);}});},getArea:function(){return $('#quesareaselect').getButtonSelected('qdid');},getType:function(){return $('#questypeselect').getButtonSelected('qdid');},getGrade:function(){return $('#questypegrade').getButtonSelected('qdid');},getKey:function(){return $('#keyword').val();},getOldKey:function(){var oldKey=$('#keepKeyWord').val();$('#keepKeyWord').val($('#keyword').val());return oldKey;},getOrder:function(){return $('#doc_px').getButtonSelected('type');},createDocDiv:function(docID,docname){var str='<span class="nav_current" id="papernav'+docID+'">'+'<table border="0" cellpadding="0" cellspacing="0">'+'<tbody><tr>'+'<td><a class="papericon"/></td>'+'<td class="cursor"><a title="【编号'+docID+'】'+docname+'">'+(docname.length>10?docname.substr(0,10):docname)+'</a></td>'+'<td><a class="paperclose" did="'+docID+'" title="关闭"/></td>'+'</tr></tbody>'+'</table>'+'</span>';$('#paperlisthandler').after(str);$('#bartitle .nav_current').addClass('nav').removeClass('nav_current');$('#bartitle #papernav'+docID).addClass('nav_current').removeClass('nav');$('#paperlistbox').css({'display':'none'});$('#paperviewbox').css({'display':'block'});$('#paperviewbox .papercontent').css({'display':'none'});$('#paperviewbox').append('<div class="papercontent" id="papercontent'+docID+'" style="margin:5px;"></div>');},showDocDiv:function(docID){$('#bartitle .nav_current').addClass('nav').removeClass('nav_current');$('#bartitle #papernav'+docID).addClass('nav_current').removeClass('nav');$('.papercontent').css({'display':'none'});$('#paperlistbox').css({'display':'none'});$('#paperviewbox').css({'display':'block'});$('#papercontent'+docID).css({'display':'block'});$('#switchbox').scrollTop(0);},openTestDoc:function(docID,thisSubjectID){if(thisSubjectID!=subjectID){return false;}
if($('#papernav'+docID).length>0){$.docTest.showDocDiv(docID);return false;}
$.myDialog.showMsg('试题载入请稍候...',0,0);$.post(U('Manual/Index/getDocTest'),'did='+docID+'&'+Math.random(),function(data){if($.myCommon.backLogin(data)==false){return false;};$.docTest.createDocDiv(docID,data['data'][0][0][0]['docname']);var tmp_str='<div style="text-align:center;margin:15px;font-size:16px;font-weight:bolder;color:#005AA0;">【编号'+docID+'】'+data['data'][0][0][0]['docname']+'</div>'+'<div style="font-weight:bold;margin:10px;text-align:center;position:relative;">试卷类型：'+'<span style="color:#005AA0;">'+data['data'][0][0][0]['typename']+'</span>'+' | 适用省份：<span style="color:#005AA0;">'+data['data'][0][0][0]['areaname']+'</span>'+' | 试卷年份：<span style="color:#005AA0;">'+data['data'][0][0][0]['docyear']+'年</span> | 上传日期：'+'<span>'+data['data'][0][0][0]['introfirsttime']+'</span> | 题数： <span>'+data['data'][1][0].length+'</span><div class="bgbt an01 addtestall" hidevalue="0"><span class="an_left"></span><a>全部加入</a><span class="an_right"></span></div></div>';tmp_str+=$.myTest.showTest(data['data'][1][0]);$("#papercontent"+docID).html(tmp_str);if(tmp_str.indexOf('delques')>0){$('#papercontent'+docID).find('.addtestall').find('a').eq(0).html('全部去除');$('#papercontent'+docID).find('.addtestall').removeClass('an01').addClass('an02');}
$('#switchbox').scrollTop(0);$('#msgdiv').css({'display':'none','opacity':0});$('#div_shadowmsgdiv').css({'display':'none'});});},paperView:function(){$('.paperview').live('click',function(){var docID=$(this).attr('did');$.docTest.openTestDoc(docID,subjectID);});},addTestAll:function(){$('.addtestall').live('click',function(){var resarr='';var overarr=new Array();var result;if($(this).find('a').eq(0).html()=='全部加入'){$(this).parent().parent().find('.addquessel').each(function(i){var thistypeid=$(this).attr('qyid');if(typeof(overarr[thistypeid])!='undefined'){return true;}
result=$.myTest.checkIfOver(this);if(!result[0]){if(resarr.indexOf(','+result[1])==-1){resarr+=','+result[1];}
return true;}
editData.addtest($(this).attr('quesid'),$(this).attr('childnum'),$(this).attr('qyname'),$(this).attr('qyid'));$.myTest.updateMainTypes($(this).attr('childnum'),$(this).attr('qyname'));var testid=$(this).attr('quesid');$('#selmore'+testid).hide();$('#selpicleft'+testid).hide();$(this).addClass('delques');$(this).removeClass('addquessel');});if(resarr!='')$.myDialog.showMsg('题型【'+resarr.substr(1)+'】试题量已满！',1);$(this).removeClass('an02').addClass('an01');$(this).find('a').eq(0).html('全部去除');}else{$(this).parent().parent().find('.delques').each(function(i){var tmp_str=editData.selecttest($(this).attr('quesid'));var testid=$(this).attr('quesid');$('#selmore'+testid).css('display','inline-block');$('#selpicleft'+testid).css('display','inline-block');if(tmp_str){editData.deltest($(this).attr('quesid'));$.myTest.updateMainTypes(0-$(this).attr('childnum'),tmp_str);$(this).addClass('addquessel');$(this).removeClass('delques');}});$(this).find('a').eq(0).html('全部加入');$(this).removeClass('an01').addClass('an02');}});},paperClose:function(){$('.paperclose').live('click',function(event){event.stopPropagation();var docID=$(this).attr('did');var currentid=$('#bartitle .nav_current').attr('id').replace('papernav','');if(currentid=='paperlisthandler'||currentid==docID)$('#paperlisthandler').click();else $.docTest.showdocdiv(currentid);$('#papernav'+docID).remove();$('#papercontent'+docID).remove();});},getKeyword:function(){$('#searchsubmit').live('click',function(){page=1;$.docTest.getDoc();});},getDoc:function(){var tid=$.docTest.getType();var area=$.docTest.getArea();var orderby=$.docTest.getOrder();var grade=$.docTest.getGrade();var key=$.docTest.getKey();var oldKey=$.docTest.getOldKey();$("#paperlist_content").html('<p class="list_ts"><span class="ico_dd">正在查询请稍候...</span></p>');lock='doc';$.post(U('Home/Index/getDocList'),{'sid':subjectID,'tid':tid,'key':key,'oldkey':oldKey,'area':area,'grade':grade,'o':orderby,'page':page,'times':Math.random()},function(data){if($.myCommon.backLogin(data)==false){lock='';$.myPage.showPage(0,1,page,1);return false;}
if(typeof(data['data'][1])!='undefined'&&data['data'][1]!=0)$("#paperlist_content").html($.docTest.showDoc(data['data'][0]));else $("#paperlist_content").html('<p class="list_ts">抱歉！暂时没有符合条件的试卷，请尝试更换查询条件。</p>');$.myPage.showPage(data['data'][1],data['data'][2],page,1);lock='';});},showDoc:function(data){var str='<div class="questablebox" style="margin:0;">'+'<table cellspacing="0" class="questable">'+'<colgroup><col class="odd"/><col class="even"/><col class="odd"/><col class="even"/><col class="odd"/></colgroup>'+'<tr>'+'<th align="center" width="50" class="oddth">编号</th>'+'<th align="center" class="eventh" width="65">分类</th>'+'<th align="center" class="oddth"  width="130">试卷属性</th>'+'<th align="left" class="oddth">试卷标题</th>'+'<th align="center" class="eventh" width="80">日期</th>'+'</tr>';for(var i in data){str+='<tr class="doc_tr">'+'<td align="center"><span>'+data[i]['docid']+'</span></td>'+'<td align="center"><span id="paperleve'+data[i]['docid']+'" levelid="1">'+data[i]['typename']+'</span></td>'+'<td align="center">'+data[i]['docyear']+'年 | '+(data[i]['areaname']==""?'通用':data[i]['areaname'])+'</td>'+'<td style="line-height:18px;"><a href="javascript:;" did="'+data[i]['docid']+'" class="paperview" style="font-size:14px;">'+data[i]['docname']+'</a>'+'</td>'+'<td align="center">'+data[i]['introfirsttime']+'</td>'+'</tr>';}
str+='</table></div>';return str;},initDivBoxHeight:function(){var a=$(window).width();var b=$(window).height();var c=$("#rightdiv").height();var d=$("#righttop").height();var e=$("#papernav").height();$("#rightdiv").width(a);$("#rightdiv").height(b-1);$("#switchbox").height(b-d-e-21);}}
jQuery.searchTest={init:function(){this.loadClassList();this.searchTest();this.initDivBoxHeight();this.showTestByOrder();this.loadPageEvent();$('#searchsubmit').clickByEnter();$(window).bind("resize",function(){$.searchTest.initDivBoxHeight();});},loadPageEvent:function(){this.jumpToPage();this.goPrevPage();this.goNextPage();this.quickToPage();},loadClassList:function(){lock='getTypes';$.post(U('Home/Index/getTypes'),{'id':subjectID,'m':Math.random()},function(data){if($.myCommon.backLogin(data)==false){lock='';return false;}
var str='<label><input type="radio" name="questype" checked="checked" value="0"/><span class="pointer">不限</span></label>';for(var i in data['data'][1]){str+='<label><input type="radio" name="questype" value="'+data['data'][1][i]['TypesID']+'"/><span class="pointer">'+data['data'][1][i]['TypesName']+'</span></label>';}
$('#questypebox').html(str);str='<label><input type="radio" name="quesdiff" checked="checked" value="0"/><span class="pointer">不限</span></label>';for(var i in data['data'][2]){str+='<label title="'+data['data'][2][i]['DiffArea']+'"><input type="radio" name="quesdiff" value="'+data['data'][2][i]['DiffID']+'"/><span class="pointer">'+data['data'][2][i]['DiffName']+'</span></label>';}
$('#quesdiffbox').html(str);str='<label><input type="radio" name="questime" checked="checked" value="0"/><span class="pointer">不限</span></label>';var data_value=new Array('onemonth','threemonth','sixmonth','oneyear','oneyearold');var data_str=new Array('一个月内','三个月内','半年内','一年内','一年外');for(var i in data_value){str+='<label><input type="radio" name="questime" value="'+data_value[i]+'"/><span class="pointer">'+data_str[i]+'</span></label>';}
$('#questimebox').html(str);$('#loca_text span').html($.myCommon.getSubjectNameFromParent());$('#questypebox').radioColor();$('#quesdiffbox').radioColor();$('#questimebox').radioColor();lock='';},'json');},searchTest:function(){$('#searchsubmit').click(function(){if($.myCommon.ajaxLoading()==false){return false;}
page=1;var keywords=$('#keyword').val();var oldkey=$.docTest.getOldKey();if($('#keyword').val().length<=1){$.myDialog.normalMsgBox('showmsg','提示信息',450,'搜索关键字长度必须大于1！',2);return false;}
$.post(U('Manual/Index/addKeyWord'),'keywords='+keywords+'&oldkey='+oldkey+'&subjectID='+subjectID+'&times='+Math.random(),function(data){if($.myCommon.backLogin(data)==false){return false;};})
$.searchTest.getTest();});},initDivBoxHeight:function(){var a=$(window).width();var b=$(window).height();$("#rightdiv").width(a);$("#rightdiv").height(b);},getTest:function(){var keyword=$('#keyword').val();var keepKeyWord=$('#keepKeyWord').val();if(keyword==''&&keepKeyWord!=''){keyword=$('#keepKeyWord').val();}
if(keyword==''){return false;}
var starttime=new Date().getTime();var newkeyword=$.myCommon.cutString(keyword,24)+'...';$('#keywordtext').html(newkeyword);$('#keywordtext').attr('title',keyword);var time=$.searchTest.getTime();var tid=$.searchTest.getTypes();var dif=$.searchTest.getDiff();var order=$.searchTest.getOrder();$("#queslistbox").html('<p class="list_ts"><span class="ico_dd">正在查询请稍候...</span></p>');lock='test';$.post(U('Home/Index/getTestList'),'sid='+subjectID+'&time='+time+'&tid='+tid+'&dif='+dif+'&o='+order+'&key='+(keyword)+'&page='+page+'&'+Math.random(),function(data){if($.myCommon.backLogin(data)==false){lock='';$("#queslistbox").html('<p class="list_ts">'+data.data+'</p>');$.myPage.showPage(0,1,page,1);$('#elapsedtime').html(new Date().getTime()-starttime);return false;};if(typeof(data['data'][0])!=''&&data['data'][0]!=''){$('#keepKeyWord').val(keyword);$("#queslistbox").html($.myTest.showTest(data['data'][0]));$.myPage.showPage(data['data'][1],data['data'][2],page,1);}else{$("#queslistbox").html('<p class="list_ts">抱歉！暂时没有符合条件的试题，请尝试更换查询条件。</p>');$.myPage.showPage(0,1,page,1);}
$('#elapsedtime').html(new Date().getTime()-starttime);lock='';},'json');},showTestByOrder:function(){$('#list_px a').live('click',function(){page=1;$(this).aOrderColor();$.searchTest.getTest();});},getOrder:function(){return $('#list_px').getButtonSelected('type');},getDiff:function(){return $('#quesdiffbox').getRadioChecked();},getTypes:function(){return $('#questypebox').getRadioChecked();},getTime:function(){return $('#questimebox').getRadioChecked();},jumpToPage:function(){$('.pagebox a').live('click',function(){$.searchTest.gotoPage(parseInt($(this).attr('page')));});},gotoPage:function(num){$('#searchresult').scrollTop(0);if(num<1&&page==1){return false;}
page=num;$.searchTest.getTest();},goPrevPage:function(){$('.prev_page').live('click',function(){if($.myPage.goPrevPage()==false)return false;$.searchTest.gotoPage(page);});},goNextPage:function(){$('.next_page').live('click',function(){if($.myPage.goNextPage()==false)return false;$.searchTest.gotoPage(page);});},quickToPage:function(){$('#quicktopage a').live('click',function(){$.myPage.quickToPage($(this));$.searchTest.gotoPage(page);});}}
var subjectID=Cookie.Get("SubjectId");Types=parent.Types;window.onerror=function(){return true;}
$(document).bind("selectstart",function(){return false;});$(document).ready(function(){$.myCommon.checkSubject(U('/Home','',false));if(subjectID){switch(mark){case'knowledge':$.knowledgeTest.init();break;case'chapter':$.chapterTest.init();break;case'doc':$.docTest.init();break;case'search':$.searchTest.init();break;}}
$.myTest.showTestEvevt();$.myPage.showQuickSkip();});